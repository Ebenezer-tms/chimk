const axios = require('axios');
const fs = require('fs');
const path = require('path');

const DEFAULT_MENU_IMAGE = 'https://res.cloudinary.com/dptzpfgtm/image/upload/v1763144874/whatsapp_uploads/xliwmfjr13kzzw6yckka.jpg';
const assetsDir = path.join(__dirname, 'assets');
const menuImagePath = path.join(assetsDir, 'menu.jpg');

async function setupDefaultMenuImage() {
    try {
        if (!fs.existsSync(assetsDir)) {
            fs.mkdirSync(assetsDir, { recursive: true });
        }

        console.log('üì• Downloading default menu image...');
        
        const response = await axios({
            method: 'GET',
            url: DEFAULT_MENU_IMAGE,
            responseType: 'stream',
            timeout: 30000
        });

        const writer = fs.createWriteStream(menuImagePath);
        response.data.pipe(writer);

        await new Promise((resolve, reject) => {
            writer.on('finish', resolve);
            writer.on('error', reject);
        });

        console.log('‚úÖ Default menu image setup successfully!');
    } catch (error) {
        console.error('‚ùå Failed to setup default menu image:', error.message);
    }
}

// Run if this script is executed directly
if (require.main === module) {
    setupDefaultMenuImage();
}

module.exports = setupDefaultMenuImage;
